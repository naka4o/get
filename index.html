
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<script>
  async function doPost() {
    document.getElementById("output").innerHTML=`    
<h3>データ送信中.. 数秒お待ちください ..</h3>
`;
// decrypto
    const URL='https://script.google.com/macros/s/AKfycbyn3kjIYtpNr6IYXhV_04GY9e6gsTOiM090MAM1WyN9Oq--uKTJoRrcPULlTeOBEghD5A/exec';
    const param='U2FsdGVkX1%2ByVECD2yA0%2FFUPWcGfxBevTiLbQIQvgZWtXRdbgDM0%2Ft%2BmhPKyOrtO';
    try {
      /*
    const res = await fetch(URL, {
      method: 'POST',
      body: JSON.stringify({param})
    });
    */
    //const url2='https://script.google.com/macros/s/AKfycbzLVksrx6uWaQsKNWyTV_as3vBmJ3FhisoGJCUv7bL_LpFPYZZyQOm02rbVMlaV173A9g/exec';
    const param='?param=U2FsdGVkX1%2ByVECD2yA0%2FFUPWcGfxBevTiLbQIQvgZWtXRdbgDM0%2Ft%2BmhPKyOrtO&no=1';
    const res = await fetch(URL+param);
    console.log(res);
    const d = await res.json();
      console.log(d);
    document.getElementById('output').innerHTML =`
<h3>ご回答、ありがとうございました。</h3>
${JSON.stringify(d.nameGrad)}<br>
${JSON.stringify(d.lastOne)}
    `; 
      document.getElementById('date').value = d.lastOne.日付.toLocalString();
      document.getElementById('name').value = d.nameGrad.name;
} catch (error) {
        console.error('エラーが発生しました:', error);
        document.getElementById('output').innerHTML = `
<strong>      
エラーが発生しました。
${error}
</strong>
`;
}
}
</script>
</head>
<body onload='doPost()'>
  <div id='output'></div>

  <input id='date'><br>
  <input id='name'><br>
</body>
</html>
